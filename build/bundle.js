(()=>{"use strict";var t,e;!function(t){t.INIT="INIT",t.CONNECTED="CONNECTED",t.LOBBY="LOBBY",t.JOIN="JOIN",t.GAME="GAME"}(t||(t={})),function(t){t.LOGIN="login",t.LOBBY="lobby",t.JOIN="join",t.GAME="game",t.BROADCAST="broadcast"}(e||(e={}));const n=function(){function t(){this.bets=[],this.onBetChange=function(t){},this.betSingleBtn=null,this.betAccumulatorBtn=null,this.betBtn=null,this.totalOutlay=null,this.maxWin=null,this.stakeInput=null,this.betsCounter=null,this.accumulator=[{counter:2,label:"Double"},{counter:3,label:"Treble"},{counter:4,label:"4-Fold"},{counter:5,label:"5-Fold"},{counter:6,label:"6-Fold"},{counter:7,label:"7-Fold"},{counter:8,label:"8-Fold"},{counter:9,label:"9-Fold"}],this.betSingleBtn=document.querySelector("#bet-type-singles"),this.betAccumulatorBtn=document.querySelector("#bet-type-accumulator"),this.totalOutlay=document.querySelector("#total-outlay"),this.maxWin=document.querySelector("#max-win"),this.stakeInput=document.querySelector(".stake-input"),this.betsCounter=document.querySelector("#bets-counter"),this.betBtn=document.querySelector("#bet-button")}return t.prototype.init=function(t){var e=this,n=t.onBetChange;this.onBetChange=n,Array.from(document.querySelectorAll(".odds-selector")).forEach(function(t){t.removeEventListener("click",e.handleBetSelect.bind(e)),t.addEventListener("click",e.handleBetSelect.bind(e))})},t.prototype.handleButtons=function(){var t=this;if(this.betSingleBtn.disabled=0===this.bets.length,this.betAccumulatorBtn.disabled=this.bets.length<2,this.betBtn.disabled=0===this.bets.length,0===this.bets.length&&(this.betSingleBtn.classList.remove("active"),this.betAccumulatorBtn.classList.remove("active"),this.betAccumulatorBtn.textContent="Accumulator"),1===this.bets.length)return this.betSingleBtn.classList.add("active"),this.betAccumulatorBtn.classList.remove("active"),void(this.betAccumulatorBtn.textContent="Accumulator");if(this.bets.length>1){this.betSingleBtn.classList.remove("active"),this.betAccumulatorBtn.classList.add("active");var e=this.accumulator.find(function(e){return e.counter===t.bets.length});e&&(this.betAccumulatorBtn.textContent=e.label)}},t.prototype.resetOddsButtons=function(){Array.from(document.querySelectorAll(".odds-selector")).forEach(function(t){return t.classList.remove("active")})},t.prototype.handleBetSelect=function(t){var e=t.target;if(e){var n=e.dataset,o=n.matchId,s=n.odds,r=n.outcome,a=e.closest(".match-fixture"),i=e.classList.contains("active");a.querySelectorAll(".odds-buttons button").forEach(function(t){return t.classList.remove("active")});var c=this.bets.findIndex(function(t){return t.matchId===o});-1!==c&&this.bets.splice(c,1),i||(e.classList.add("active"),this.bets.push({matchId:o,outcome:r,odds:s})),this.onBetChange(this.bets),this.handleButtons(),this.updateCalculations()}},t.prototype.updateCalculations=function(){var t=this.bets.length,e=this.stakeInput.dataset.stake,n=0;if(0===t)return this.totalOutlay&&(this.totalOutlay.textContent="0.00"),this.maxWin&&(this.maxWin.textContent="0.00"),void(this.betsCounter&&(this.betsCounter.textContent="0"));this.totalOutlay.textContent=(e*t).toFixed(2),n=this.bets.reduce(function(t,e){return t*e.odds},1)*e,this.maxWin.textContent=n.toFixed(2),this.betsCounter&&(this.betsCounter.textContent=String(this.bets.length))},t.prototype.resetBets=function(){this.bets=[],this.updateCalculations(),this.onBetChange(this.bets),this.handleButtons(),this.resetOddsButtons()},t}(),o=function(){function t(){this.hiddenClass="hide"}return t.prototype.showModal=function(t,e){void 0===e&&(e=""),e&&t.querySelector("p")&&(t.querySelector("p").textContent=e),t&&t.classList.remove(this.hiddenClass)},t.prototype.hideModal=function(t){t&&t.classList.add(this.hiddenClass)},t.prototype.showBetModal=function(){var t=this,e=document.querySelector("#bet-modal"),n=document.querySelector(".modal-close-btn");return this.showModal(e,"Outright Bet Placed Successfully"),new Promise(function(o){n&&(n.removeEventListener("click",t.hideModal),n.addEventListener("click",function(){t.hideModal(e),o()})),setTimeout(function(){t.hideModal(e),o()},2e3)})},t.prototype.showBetHistory=function(){var t=document.querySelector("#bet-history-modal");t&&this.showModal(t)},t}();const s=function(){function t(){this.countdownInterval=null}return t.prototype.renderLeagueTable=function(t){var e=document.querySelector(".legue-table"),n=document.querySelector("#league-body");if(e&&n){n.innerHTML="",e.querySelector("thead").innerHTML="";var o=e.querySelector("thead"),s=document.createElement("tr");t.gridData.headers.forEach(function(t){var e=document.createElement("th");e.innerHTML=t,s.appendChild(e)}),t.gridData.rows.forEach(function(t){if(document.createElement("tr"),Array.isArray(t)&&t.length>0){var e=document.createElement("tr");t.forEach(function(t){var n=document.createElement("td");n.innerHTML=t,e.appendChild(n)}),n.appendChild(e)}}),o.appendChild(s)}},t.prototype.renderCountdownTimer=function(t){var e=this,n=document.querySelector("#countdown");clearInterval(this.countdownInterval);var o=t||0;n&&(n.textContent=String(o)),this.countdownInterval=setInterval(function(){--o>=0?n&&(n.textContent=String(o)):clearInterval(e.countdownInterval)},1e3)},t.prototype.renderMatchBettingOptions=function(t){var e=document.querySelector(".match-betting-options");e&&0!==t.matches.length&&(e.innerHTML="",t.matches.forEach(function(t){var n=document.createElement("div");n.className="match-fixture";var o=t.odds;o&&(n.innerHTML='<div class="teams-container"><div class="team-name team-a">'.concat(t.t1,'</div><div class="team-name team-b">').concat(t.t2,'</div></div><div class="odds-buttons"><button data-match-id="').concat(t.id,'" data-outcome="1" data-odds="').concat(o[0],'" class="odds-selector">').concat(o[0],'</button><button data-match-id="').concat(t.id,'" data-outcome="X" data-odds="').concat(o[1],'" class="odds-selector">').concat(o[1],'</button><button data-match-id="').concat(t.id,'" data-outcome="2" data-odds="').concat(o[2],'" class="odds-selector">').concat(o[2],"</button></div>"),e.appendChild(n))}))},t.prototype.renderKnockoutResults=function(t){var e=document.querySelector("#knockout-results-display");e&&e.classList.remove("hide")},t.prototype.renderRoundName=function(t){var e=document.querySelector("#round-name");e&&(e.innerHTML=t.name)},t.prototype.renderTournamentName=function(t){var e=document.querySelector("#tournament-name");e&&(e.innerHTML=t.name)},t.prototype.renderBalance=function(t){var e="\n    ".concat(t.currency,"\n    ").concat(parseFloat(t.amount).toFixed(t.decimalPrecision)),n=document.querySelector("#balance");n&&(n.innerHTML=e)},t.prototype.displayMatchResults=function(t,e){void 0===e&&(e="");var n=document.getElementById("results-list"),o=document.getElementById("round-summary"),s=document.getElementById("results-round-name");return new Promise(function(r){if(n&&(n.innerHTML=""),o&&(o.innerHTML=""),t&&t.matches&&n){s&&(s.textContent="Match Results: ".concat(e," ").concat(t.name));var a=t.matches;a.forEach(function(t,e){setTimeout(function(){var o=document.createElement("div");o.className="result-item",o.innerHTML='<div class="main-score-line"><span class="result-team-name result-team-a">'.concat(t.t1,'</span>\n\t\t\t\t\t<span class="result-score">').concat(t.sc[0]," - ").concat(t.sc[1],'</span>\n\t\t\t\t\t<span class="result-team-name result-team-b">').concat(t.t2,"</span></div>"),n.appendChild(o),setTimeout(function(){return o.classList.add("visible")},50),e===a.length-1&&r()},500*e)})}else r()})},t.prototype.renderMatchResults=function(t,e){return n=this,o=void 0,r=function(){var n,o;return function(t,e){var n,o,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(r=0)),r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=e.call(t,r)}catch(t){i=[6,t],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,function(s){switch(s.label){case 0:return n=document.querySelector("#transition-screen"),o=document.querySelector("#results-screen"),n&&n.classList.remove("hide"),[4,new Promise(function(t){return setTimeout(t,2e3)})];case 1:return s.sent(),n&&n.classList.add("hide"),o&&o.classList.remove("hide"),[4,this.displayMatchResults(t,e)];case 2:return s.sent(),[4,new Promise(function(t){return setTimeout(t,2e3)})];case 3:return s.sent(),o&&o.classList.add("hide"),[2]}})},new((s=void 0)||(s=Promise))(function(t,e){function a(t){try{c(r.next(t))}catch(t){e(t)}}function i(t){try{c(r.throw(t))}catch(t){e(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s(function(t){t(n)})).then(a,i)}c((r=r.apply(n,o||[])).next())});var n,o,s,r},t}(),r=function(){function t(t){var e=t.onStakeChange,n=this;this.stakes=[],this.stakeIndex=0,this.currency="",this.decimalPrecision=2,this.changeStake=function(t){if(n.stakeInput){var e=String(n.stakes[t]||0),o="".concat(n.currency," ").concat(parseFloat(e).toFixed(n.decimalPrecision));n.stakeInput.innerHTML=o,n.stakeInput.dataset.stake=parseFloat(e).toFixed(n.decimalPrecision),n.onStakeChange(parseFloat(e).toFixed(n.decimalPrecision))}},this.setStakeSelectorActions=function(){n.stakeUp.addEventListener("click",n.prevStakes.bind(n)),n.stakeDown.addEventListener("click",n.nextStakes.bind(n))},this.getCurrentStake=function(){return n.stakes[n.stakeIndex]},this.onStakeChange=e}return t.prototype.init=function(t){this.stakeInput=document.querySelector(".stake-input"),this.stakeUp=document.querySelector(".stake-up"),this.stakeDown=document.querySelector(".stake-down"),this.currency=t.credit.currency,this.decimalPrecision=t.credit.decimalPrecision,t.stakeValues&&Array.isArray(t.stakeValues)&&t.stakeValues.length>0&&(this.stakes=t.stakeValues,t.defaultStake&&(this.stakeIndex=this.stakes.findIndex(function(e){return e===t.defaultStake}),this.changeStake(this.stakeIndex))),this.setStakeSelectorActions()},t.prototype.setStakesButtonsState=function(){0===this.stakeIndex?this.stakeUp.disabled=!0:this.stakeUp.disabled=!1,this.stakeIndex===this.stakes.length-1?this.stakeDown.disabled=!0:this.stakeDown.disabled=!1},t.prototype.prevStakes=function(){this.stakeIndex-1>=0&&(this.stakeIndex=this.stakeIndex-1,this.changeStake(this.stakeIndex),this.setStakesButtonsState())},t.prototype.nextStakes=function(){this.stakeIndex+1<this.stakes.length&&(this.stakeIndex=this.stakeIndex+1,this.changeStake(this.stakeIndex),this.setStakesButtonsState())},t}();var a=function(){function t(t){var e=t.onReady,n=t.onError,o=t.onResponse,s=t.onBroadcastResponse;this.name="WS: Connector",this.ws=null,this.connected=!1,this.isLogged=!0,this.sessionID="",this.lastAction=null,this.hasError=!1,this.queryParams=new Proxy(new URLSearchParams(window.location.search),{get:function(t,e){return t.get(e)}}),this.onBroadcastResponse=s,this.onReady=e,this.onError=n,this.onResponse=o}return t.prototype.init=function(){if(!this.validateParams())return this.triggerErrorModal("Invalid Game Params"),!1;this.connect()},t.prototype.connect=function(){this.ws=new WebSocket("wss://".concat(this.queryParams.endpoint)),this.ws.addEventListener("error",this.onSocketError.bind(this)),this.ws.addEventListener("close",this.onClose.bind(this)),this.ws.addEventListener("message",this.onMessage.bind(this)),this.ws.addEventListener("open",this.onOpen.bind(this))},t.prototype.onSocketError=function(t){this.triggerErrorModal("Websocket Error"),this.log("[error]"),this.connected=!1},t.prototype.isConnected=function(){return void 0!==this.ws&&this.ws.readyState===WebSocket.OPEN},t.prototype.onClose=function(t){this.connected=!1,t.wasClean?this.log("[close] Connection closed cleanly, code=".concat(t.code," reason=").concat(t.reason)):this.log("[close] Connection closed"),this.triggerErrorModal("[close] Connection closed")},t.prototype.send=function(t){if(!this.isConnected())return this.log("[Sending error:: Server disconnected]");this.ws.send(JSON.stringify(t))},t.prototype.onMessage=function(t){var n=JSON.parse(t.data);return n.response&&n.response.requestType===e.BROADCAST||n.requestType===e.BROADCAST?this.onBroadcastResponse(n):n.response&&n.response.requestType===this.lastAction||n.requestType&&n.requestType===this.lastAction?n.error?void this.triggerErrorModal(n.error.errorMessage):(n.response?this.onResponse(n.response):this.onResponse(n),"LOGIN"===this.lastAction?this.handleLoginResponse(n.response):void 0):this.log("[Invalid Socket Response]")},t.prototype.onOpen=function(){this.connected=!0,this.onReady(),this.log("[ws: open]")},t.prototype.validateParams=function(){return null!=this.queryParams.siteID&&""!==this.queryParams.siteID&&null!=this.queryParams.gameID&&""!==this.queryParams.gameID&&null!=this.queryParams.endpoint&&""!==this.queryParams.endpoint&&null!=this.queryParams.playToken&&""!==this.queryParams.playToken||(this.log("Invalid game params"),!1)},t.prototype.triggerErrorModal=function(t){this.onError(t)},t.prototype.login=function(){this.lastAction=e.LOGIN,this.send({brandID:this.queryParams.brandID,fixedID:"",funReal:this.queryParams.funReal||-1,gameID:this.queryParams.gameID,requestType:e.LOGIN,sessionID:this.queryParams.playToken,siteID:this.queryParams.siteID})},t.prototype.lobby=function(){this.lastAction=e.LOBBY,this.send({requestType:e.LOBBY})},t.prototype.join=function(t){this.lastAction=e.JOIN,this.send({requestType:e.JOIN,roomTypeId:t,roomId:null})},t.prototype.handleLoginResponse=function(t){return t.playerDetails.sessionID&&(this.isLogged=!0,this.sessionID=t.playerDetails.sessionID),!1},t.prototype.bet=function(t){t&&0!==t.length&&(this.lastAction=e.GAME,this.send({requestType:e.GAME,publicState:{action:"BET",payload:{bets:t}}}))},t.prototype.log=function(t){console.groupCollapsed("%c ".concat(this.name," :: INFO "),"background: blue; color: white; display: block;"),console.log(t),console.groupEnd()},t}();const i=a;var c,u,l,d,h=function(t,e,n,o){return new(n||(n=Promise))(function(s,r){function a(t){try{c(o.next(t))}catch(t){r(t)}}function i(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,i)}c((o=o.apply(t,e||[])).next())})},p=function(t,e){var n,o,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(r=0)),r;)try{if(n=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=e.call(t,r)}catch(t){i=[6,t],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},m=null,y=null,f=null,b=0,v=[],g=function(t){var e=document.querySelector("#error");e.classList.remove("hide"),e.querySelector("p").innerHTML=t},k=function(e){return h(void 0,void 0,void 0,function(){var n,o;return p(this,function(s){switch(n=document.querySelector("#LoadingScreen"),o=document.querySelector("#GameScreen"),e){case t.INIT:n.classList.remove("hide"),c.init();break;case t.CONNECTED:c.login();break;case t.LOBBY:c.lobby();break;case t.JOIN:if(!m||!0!==Array.isArray(m.rooms)||0===m.rooms.length)return[2,g("Invalid Room.")];c.join(m.id);break;case t.GAME:n.classList.add("hide"),o.classList.remove("hide")}return[2]})})},S=function(t){return v=t},I=function(n){switch(n.requestType){case e.LOGIN:u.init(n),f.renderBalance(n.credit),k(t.LOBBY);break;case e.LOBBY:(void 0!==(o=n.roomTypes)||null!==o)&&(m=n.roomTypes[0],f.renderTournamentName(m),k(t.JOIN));break;case e.JOIN:k(t.GAME),y=n.publicView,f.renderLeagueTable(y.tournament.league),f.renderCountdownTimer(y.secsToExtr),f.renderMatchBettingOptions(y.currentRound),l.init({onBetChange:S}),f.renderRoundName(y.currentRound)}var o},B=function(t){y=t.publicView,f.renderMatchResults(y.previousRound,m.name),f.renderLeagueTable(y.tournament.league),f.renderCountdownTimer(y.secsToExtr),f.renderRoundName(y.currentRound),f.renderMatchBettingOptions(y.currentRound),l.init({onBetChange:S}),l.resetBets()},w=function(t){l.updateCalculations(),b=t},L=function(){return h(void 0,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return v&&0!==v.length&&b?(t=v.map(function(t){return{matchId:t.matchId,outcome:t.outcome,stake:b}}),c.bet(t),[4,d.showBetModal()]):[2];case 1:return e.sent(),l.resetBets(),[2]}})})};document.addEventListener("DOMContentLoaded",function(){!function(){u=new r({onStakeChange:w}),f=new s,l=new n,c=new i({onReady:function(){return k(t.CONNECTED)},onError:g,onBroadcastResponse:B,onResponse:I}),d=new o,document.querySelector(".bet-button").addEventListener("click",L);var e=document.querySelector(".match-info-bar"),a=document.querySelector("#bet-history-modal"),h=document.getElementById("bet-history-close-btn");e&&e.addEventListener("click",function(){return d.showBetHistory()}),h&&h.addEventListener("click",function(){return d.hideModal(a)}),document.head.title="Turbo Footbal",document.querySelector("#reloadBtn").addEventListener("click",function(t){t.preventDefault(),window.location.reload()}),k(t.INIT)}()})})();